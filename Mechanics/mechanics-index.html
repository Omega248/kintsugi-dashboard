<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kintsugi Motorworks · Mechanics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'kintsugi-bg-primary': '#020817',
            'kintsugi-bg-secondary': '#050816',
            'kintsugi-bg-tertiary': '#030712',
            'kintsugi-border-subtle': '#111827',
            'kintsugi-border-default': '#1f2937',
            'kintsugi-border-strong': '#374151',
            'kintsugi-text-primary': '#e5e7eb',
            'kintsugi-text-secondary': '#9ca3af',
            'kintsugi-text-tertiary': '#6b7280',
            'kintsugi-accent': '#4f46e5',
            'kintsugi-accent-secondary': '#6366f1',
            'kintsugi-accent-hover': 'rgba(148, 163, 253, 0.12)',
          },
          fontSize: {
            'xs': '9px',
            'sm': '10px',
            'base': '11px',
            'md': '13px',
            'lg': '14px',
            'xl': '18px',
            '2xl': '24px',
            '4xl': '39px',
          },
          borderRadius: {
            'md': '12px',
            'lg': '18px',
            'xl': '22px',
          },
          boxShadow: {
            'kintsugi-soft': '0 24px 70px rgba(0, 0, 0, 0.9)',
            'kintsugi-card': '0 20px 60px rgba(0, 0, 0, 0.75)',
          },
        },
      },
    }
  </script>
  <style>
    body::before {
      content: "";
      position: fixed;
      inset: -40vh -40vw;
      z-index: -1;
      pointer-events: none;
      background: radial-gradient(circle at top, #111827 0%, #020817 35%, #000 75%);
      opacity: 1;
    }
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.03;
      mix-blend-mode: overlay;
    }
    .brand-title-gradient {
      background: linear-gradient(135deg, #e5e7eb 0%, #d4af37 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .brand-title-line::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 90px;
      height: 2px;
      background: linear-gradient(90deg, transparent, #d4af37, transparent);
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
    }
    .nav-pill-active {
      background: radial-gradient(circle at top left, #6366f1, #4f46e5);
      box-shadow: 0 0 16px rgba(79, 70, 229, 0.9), 0 0 4px rgba(212, 175, 55, 0.3);
    }
    .page-shell-bg {
      background: linear-gradient(135deg, rgba(10, 14, 28, 0.92), rgba(6, 10, 20, 0.96));
    }
    table { border-collapse: collapse; }
    th { position: sticky; top: 0; z-index: 5; }
    
    /* Dynamic Mechanic Detail Elements */
    .mechanic-detail-empty {
      font-size: 11px;
      color: #9ca3af;
      line-height: 1.5;
      text-align: center;
    }
    .mechanic-detail-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }
    .mechanic-detail-item {
      padding: 10px 10px 8px;
      border-radius: 12px;
      border: 1px solid rgba(24, 32, 56, 0.9);
      background: #060b1a;
    }
    .mechanic-detail-item-label {
      font-size: 10px;
      color: #9ca3af;
      margin-bottom: 2px;
    }
    .mechanic-detail-item-value {
      font-size: 12px;
      font-weight: 500;
      color: #e5e7eb;
    }
    
    /* Weekly Summary Dynamic Elements */
    .weekly-summary-empty {
      font-size: 11px;
      color: #9ca3af;
      line-height: 1.5;
      text-align: center;
      padding: 20px;
    }
    .weekly-summary-card {
      margin-bottom: 12px;
      padding: 12px;
      border-radius: 12px;
      border: 1px solid rgba(24, 32, 56, 0.9);
      background: #060b1a;
    }
    .weekly-summary-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid rgba(24, 32, 56, 0.7);
    }
    .weekly-summary-week {
      font-size: 11px;
      font-weight: 600;
      color: #6366f1;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .weekly-summary-copy-btn {
      padding: 4px 10px;
      border-radius: 8px;
      border: 1px solid rgba(24, 32, 56, 0.9);
      background: rgba(79, 70, 229, 0.1);
      color: #6366f1;
      font-size: 10px;
      cursor: pointer;
      transition: all 0.15s ease;
    }
    .weekly-summary-copy-btn:hover {
      background: rgba(79, 70, 229, 0.2);
      border-color: #4f46e5;
    }
    .weekly-summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 6px;
      font-size: 11px;
    }
    .weekly-summary-label {
      color: #9ca3af;
    }
    .weekly-summary-value {
      color: #e5e7eb;
      font-weight: 500;
    }
    .weekly-summary-copy-all {
      margin-top: 16px;
      padding: 10px 16px;
      width: 100%;
      border-radius: 12px;
      border: 1px solid #4f46e5;
      background: rgba(79, 70, 229, 0.15);
      color: #6366f1;
      font-size: 11px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s ease;
      text-align: center;
    }
    .weekly-summary-copy-all:hover {
      background: rgba(79, 70, 229, 0.25);
      border-color: #6366f1;
    }
    
    /* Responsive */
    @media (max-width: 900px) {
      .mechanic-detail-grid {
        grid-template-columns: minmax(0, 1fr);
      }
    }
  </style>
  <script src="../constants.js"></script>
  <script src="../utils.js"></script>
  <script src="../payout-helpers.js"></script>
  <script src="../ui-enhancements.js"></script>
  <script src="../kintsugi-core.js"></script>
</head>
<body class="m-0 p-[18px] font-sans text-kintsugi-text-primary bg-black overflow-x-hidden leading-normal">
  <div class="max-w-[1600px] mx-auto">
    <!-- Top Navigation -->
    <header class="flex flex-col items-center justify-start gap-3 mb-5">
      <div>
        <div class="text-4xl font-bold tracking-wide text-center relative pb-1 brand-title-gradient brand-title-line">
          Kintsugi Motorworks
        </div>
        <div class="mt-1.5 text-md uppercase tracking-[0.22em] text-kintsugi-text-secondary text-center">
          Mechanic performance profiles
        </div>
      </div>

      <nav class="inline-flex p-1 rounded-full bg-gradient-to-br from-[rgba(10,16,32,0.98)] to-[rgba(15,23,42,0.95)] border border-[rgba(79,70,229,0.15)] gap-1 shadow-[0_8px_24px_rgba(0,0,0,0.7),0_0_1px_rgba(79,70,229,0.5)] backdrop-blur-sm" aria-label="Primary navigation">
        <a href="../index.html" class="px-[22px] py-2 rounded-full text-base text-kintsugi-text-secondary border border-transparent transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden hover:text-kintsugi-text-primary hover:bg-kintsugi-accent-hover hover:border-[rgba(79,70,229,0.35)] hover:-translate-y-px">Dashboard</a>
        <a href="../Payouts/payouts-index.html" class="px-[22px] py-2 rounded-full text-base text-kintsugi-text-secondary border border-transparent transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden hover:text-kintsugi-text-primary hover:bg-kintsugi-accent-hover hover:border-[rgba(79,70,229,0.35)] hover:-translate-y-px">Payouts</a>
        <a href="mechanics-index.html" class="px-[22px] py-2 rounded-full text-base text-white border border-[rgba(212,175,55,0.2)] transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden nav-pill-active">Mechanics</a>
        <a href="../Bank_Record/bank-index.html" class="px-[22px] py-2 rounded-full text-base text-kintsugi-text-secondary border border-transparent transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden hover:text-kintsugi-text-primary hover:bg-kintsugi-accent-hover hover:border-[rgba(79,70,229,0.35)] hover:-translate-y-px">Bank</a>
      </nav>
    </header>

    <main class="mt-4 rounded-xl border border-[rgba(255,255,255,0.03)] shadow-kintsugi-card p-7 flex flex-col gap-4 page-shell-bg">
      <!-- Summary intro -->
      <section class="flex flex-col items-center text-center gap-1 mb-4">
        <div class="max-w-[600px]">
          <div class="text-[20px] font-semibold text-kintsugi-text-primary tracking-[0.02em]">Mechanic stats overview</div>
          <p class="mt-1.5 text-md text-kintsugi-text-secondary leading-normal">
            Live totals and activity range pulled from jobs + payouts data.
          </p>
          <a
            class="text-base text-kintsugi-accent-secondary no-underline inline-flex items-center gap-1 mt-1 transition-all duration-[150ms] hover:underline hover:decoration-2"
            href="https://docs.google.com/spreadsheets/d/1EJxx9BAUyBgj9XImCXQ5_3nr_o5BXyLZ9SSkaww71Ks/edit"
            target="_blank"
            rel="noopener noreferrer"
          >
            Open source sheet
          </a>
        </div>
      </section>

      <!-- Global summary cards -->
      <section class="mt-4 grid grid-cols-4 gap-5" aria-label="Global mechanic summary">
        <div class="p-[18px] rounded-lg border border-kintsugi-border-default bg-gradient-to-br from-[rgba(10,14,28,0.85)] to-[rgba(6,10,20,0.90)] shadow-[0_12px_40px_rgba(0,0,0,0.6)] transition-all duration-200 hover:-translate-y-1 hover:shadow-[0_16px_50px_rgba(0,0,0,0.8)] hover:border-kintsugi-accent">
          <div class="text-xs uppercase tracking-[0.12em] text-kintsugi-text-secondary mb-2">Total mechanics</div>
          <div id="sumTotalMechanics" class="text-2xl font-semibold text-kintsugi-text-primary mb-1">–</div>
          <div id="sumTotalMechanicsSub" class="text-sm text-kintsugi-text-tertiary"></div>
        </div>
        <div class="p-[18px] rounded-lg border border-kintsugi-border-default bg-gradient-to-br from-[rgba(10,14,28,0.85)] to-[rgba(6,10,20,0.90)] shadow-[0_12px_40px_rgba(0,0,0,0.6)] transition-all duration-200 hover:-translate-y-1 hover:shadow-[0_16px_50px_rgba(0,0,0,0.8)] hover:border-kintsugi-accent">
          <div class="text-xs uppercase tracking-[0.12em] text-kintsugi-text-secondary mb-2">Total repairs</div>
          <div id="sumTotalRepairs" class="text-2xl font-semibold text-kintsugi-text-primary mb-1">–</div>
          <div id="sumTotalRepairsSub" class="text-sm text-kintsugi-text-tertiary"></div>
        </div>
        <div class="p-[18px] rounded-lg border border-kintsugi-border-default bg-gradient-to-br from-[rgba(10,14,28,0.85)] to-[rgba(6,10,20,0.90)] shadow-[0_12px_40px_rgba(0,0,0,0.6)] transition-all duration-200 hover:-translate-y-1 hover:shadow-[0_16px_50px_rgba(0,0,0,0.8)] hover:border-kintsugi-accent">
          <div class="text-xs uppercase tracking-[0.12em] text-kintsugi-text-secondary mb-2">Lifetime mechanic payout</div>
          <div id="sumTotalPayout" class="text-2xl font-semibold text-kintsugi-text-primary mb-1">–</div>
          <div id="sumTotalPayoutSub" class="text-sm text-kintsugi-text-tertiary"></div>
        </div>
        <div class="p-[18px] rounded-lg border border-kintsugi-border-default bg-gradient-to-br from-[rgba(10,14,28,0.85)] to-[rgba(6,10,20,0.90)] shadow-[0_12px_40px_rgba(0,0,0,0.6)] transition-all duration-200 hover:-translate-y-1 hover:shadow-[0_16px_50px_rgba(0,0,0,0.8)] hover:border-kintsugi-accent">
          <div class="text-xs uppercase tracking-[0.12em] text-kintsugi-text-secondary mb-2">Activity range</div>
          <div id="sumActivityRange" class="text-2xl font-semibold text-kintsugi-text-primary mb-1">–</div>
          <div id="sumActivityRangeSub" class="text-sm text-kintsugi-text-tertiary"></div>
        </div>
      </section>

      <!-- Controls -->
      <section class="flex flex-wrap gap-2 items-center text-base" aria-label="Mechanic filters">
        <span class="text-kintsugi-text-secondary text-sm">Mechanic:</span>
        <span class="relative inline-flex items-center">
          <select id="mechanicFilter" class="px-[10px] py-1.5 pr-[26px] rounded-full border border-kintsugi-border-strong bg-kintsugi-bg-secondary text-kintsugi-text-primary text-base font-sans appearance-none cursor-pointer transition-all duration-[180ms] hover:border-kintsugi-accent focus:outline-none focus:border-kintsugi-accent focus:shadow-[0_0_0_3px_rgba(79,70,229,0.22)]">
            <option value="all">All mechanics</option>
          </select>
          <span class="absolute right-[10px] top-1/2 -translate-y-[52%] text-xs text-kintsugi-text-secondary pointer-events-none">▾</span>
        </span>

        <span class="text-kintsugi-text-secondary text-sm">Time:</span>
        <span class="relative inline-flex items-center">
          <select id="timeFilter" class="px-[10px] py-1.5 pr-[26px] rounded-full border border-kintsugi-border-strong bg-kintsugi-bg-secondary text-kintsugi-text-primary text-base font-sans appearance-none cursor-pointer transition-all duration-[180ms] hover:border-kintsugi-accent focus:outline-none focus:border-kintsugi-accent focus:shadow-[0_0_0_3px_rgba(79,70,229,0.22)]">
            <option value="all">All time</option>
            <option value="last4w">Last 4 weeks</option>
            <option value="last3m">Last 3 months</option>
            <option value="last6m">Last 6 months</option>
            <option value="last12m">Last 12 months</option>
            <option value="thisMonth">This month</option>
          </select>
          <span class="absolute right-[10px] top-1/2 -translate-y-[52%] text-xs text-kintsugi-text-secondary pointer-events-none">▾</span>
        </span>

        <span class="text-kintsugi-text-secondary text-sm">Sort by:</span>
        <span class="relative inline-flex items-center">
          <select id="sortBy" class="px-[10px] py-1.5 pr-[26px] rounded-full border border-kintsugi-border-strong bg-kintsugi-bg-secondary text-kintsugi-text-primary text-base font-sans appearance-none cursor-pointer transition-all duration-[180ms] hover:border-kintsugi-accent focus:outline-none focus:border-kintsugi-accent focus:shadow-[0_0_0_3px_rgba(79,70,229,0.22)]">
            <option value="totalRepairs">Total repairs</option>
            <option value="avgPerWeek">Average repairs / week</option>
            <option value="weeksWorked">Weeks worked</option>
            <option value="monthsActive">Months active</option>
            <option value="lifetimePayout">Lifetime payout</option>
            <option value="name">Mechanic name (A → Z)</option>
          </select>
          <span class="absolute right-[10px] top-1/2 -translate-y-[52%] text-xs text-kintsugi-text-secondary pointer-events-none">▾</span>
        </span>

        <span class="text-kintsugi-text-secondary text-sm">Search:</span>
        <span class="inline-flex items-center">
          <input
            id="searchBox"
            type="search"
            placeholder="Search mechanic name..."
            class="min-w-[200px] px-[10px] py-1.5 rounded-full border border-kintsugi-border-strong bg-kintsugi-bg-primary text-kintsugi-text-primary text-base font-sans outline-none transition-all duration-200 ease-[cubic-bezier(0.4,0,0.2,1)] hover:border-kintsugi-accent focus:border-kintsugi-accent focus:shadow-[0_0_0_3px_rgba(79,70,229,0.22)] focus:scale-[1.01]"
          />
        </span>
      </section>

      <!-- Mechanics table + details + weekly summary -->
      <section class="grid grid-cols-1 lg:grid-cols-[1fr_400px] gap-5 mt-6">
        <!-- Left side: Mechanics table and lifetime details -->
        <div class="flex flex-col gap-4">
          <div class="p-5 rounded-lg border border-kintsugi-border-subtle bg-kintsugi-bg-secondary shadow-[0_12px_40px_rgba(0,0,0,0.6)]">
            <div class="mb-4 pb-3 border-b border-kintsugi-border-subtle">
              <div class="text-lg font-semibold text-kintsugi-text-primary">Mechanics</div>
              <div id="mechanicsTableSub" class="text-sm text-kintsugi-text-secondary mt-1">
                All mechanics. All time.
              </div>
            </div>

            <div class="overflow-auto max-h-[500px] rounded-md border border-kintsugi-border-subtle bg-kintsugi-bg-primary">
              <table class="w-full table-auto text-sm">
                <thead>
                  <tr>
                    <th class="p-3 border-b border-[#0f172a] text-left bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Mechanic</th>
                    <th class="p-3 border-b border-[#0f172a] text-center bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Total repairs</th>
                    <th class="p-3 border-b border-[#0f172a] text-center bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Weeks worked</th>
                    <th class="p-3 border-b border-[#0f172a] text-center bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Months active</th>
                    <th class="p-3 border-b border-[#0f172a] text-center bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Avg / week</th>
                    <th class="p-3 border-b border-[#0f172a] text-center bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Lifetime payout</th>
                    <th class="p-3 border-b border-[#0f172a] text-center bg-gradient-to-r from-[#020617] to-[#020817] text-xs uppercase tracking-[0.16em] text-kintsugi-text-secondary font-semibold sticky top-0 z-5">Last job</th>
                  </tr>
                </thead>
                <tbody id="mechanicsBody" class="[&>tr]:transition-all [&>tr]:duration-200 [&>tr]:cursor-pointer [&>tr:nth-child(even)]:bg-kintsugi-bg-tertiary [&>tr:hover]:bg-[rgba(79,70,229,0.18)] [&>tr:hover]:scale-[1.01] [&>tr>td]:p-3 [&>tr>td]:border-b [&>tr>td]:border-[#0f172a] [&>tr>td]:text-center [&>tr>td:first-child]:text-left"></tbody>
              </table>
            </div>
          </div>

          <!-- Mechanic detail integrated under table -->
          <div class="p-5 rounded-lg border border-kintsugi-border-subtle bg-kintsugi-bg-secondary shadow-[0_12px_40px_rgba(0,0,0,0.6)]">
            <div class="mb-4 pb-3 border-b border-kintsugi-border-subtle">
              <div id="detailTitle" class="text-lg font-semibold text-kintsugi-text-primary">Mechanic details</div>
              <div id="detailSubtitle" class="text-sm text-kintsugi-text-secondary mt-1">
                Select a mechanic from the table or dropdown.
              </div>
            </div>
            <div id="mechanicDetail" class="min-h-[120px] p-4 rounded-md bg-kintsugi-bg-primary border border-kintsugi-border-subtle">
              <div class="text-center text-kintsugi-text-secondary py-8">
                No mechanic selected. Choose a mechanic to see breakdown for
                repairs, weeks worked and payout.
              </div>
            </div>
          </div>
        </div>

        <!-- Right side: Weekly payout summary -->
        <div class="p-5 rounded-lg border border-kintsugi-border-subtle bg-kintsugi-bg-secondary shadow-[0_12px_40px_rgba(0,0,0,0.6)] h-fit">
          <div class="mb-4 pb-3 border-b border-kintsugi-border-subtle">
            <div class="text-lg font-semibold text-kintsugi-text-primary">Weekly Payout Summary</div>
            <div id="weeklySummarySubtitle" class="text-sm text-kintsugi-text-secondary mt-1">
              Select a mechanic to view weekly breakdown.
            </div>
          </div>
          
          <div id="weeklySummaryContent" class="min-h-[300px] p-4 rounded-md bg-kintsugi-bg-primary border border-kintsugi-border-subtle">
            <div class="text-center text-kintsugi-text-secondary py-12">
              No mechanic selected. Choose a mechanic to see their weekly payout summary.
            </div>
          </div>
        </div>
      </section>

      <div id="status" class="text-xs text-kintsugi-text-secondary mt-1 text-center"></div>
    </main>
  </div>

  <script src="mechanics-script.js"></script>
</body>
</html>
