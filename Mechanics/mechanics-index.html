<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kintsugi Motorworks · Mechanics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'kintsugi-bg-primary': '#020817',
            'kintsugi-bg-secondary': '#050816',
            'kintsugi-bg-tertiary': '#030712',
            'kintsugi-border-subtle': '#111827',
            'kintsugi-border-default': '#1f2937',
            'kintsugi-border-strong': '#374151',
            'kintsugi-text-primary': '#e5e7eb',
            'kintsugi-text-secondary': '#9ca3af',
            'kintsugi-text-tertiary': '#6b7280',
            'kintsugi-accent': '#4f46e5',
            'kintsugi-accent-secondary': '#6366f1',
            'kintsugi-accent-hover': 'rgba(148, 163, 253, 0.12)',
          },
          fontSize: {
            'xs': '9px',
            'sm': '10px',
            'base': '11px',
            'md': '13px',
            'lg': '14px',
            'xl': '18px',
            '2xl': '24px',
            '4xl': '39px',
          },
          borderRadius: {
            'md': '12px',
            'lg': '18px',
            'xl': '22px',
          },
          boxShadow: {
            'kintsugi-soft': '0 24px 70px rgba(0, 0, 0, 0.9)',
            'kintsugi-card': '0 20px 60px rgba(0, 0, 0, 0.75)',
          },
        },
      },
    }
  </script>
  <style>
    body::before {
      content: "";
      position: fixed;
      inset: -40vh -40vw;
      z-index: -1;
      pointer-events: none;
      background: radial-gradient(circle at top, #111827 0%, #020817 35%, #000 75%);
      opacity: 1;
    }
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      opacity: 0.03;
      mix-blend-mode: overlay;
    }
    .brand-title-gradient {
      background: linear-gradient(135deg, #e5e7eb 0%, #d4af37 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .brand-title-line::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 90px;
      height: 2px;
      background: linear-gradient(90deg, transparent, #d4af37, transparent);
      box-shadow: 0 0 10px rgba(212, 175, 55, 0.4);
    }
    .nav-pill-active {
      background: radial-gradient(circle at top left, #6366f1, #4f46e5);
      box-shadow: 0 0 16px rgba(79, 70, 229, 0.9), 0 0 4px rgba(212, 175, 55, 0.3);
    }
    .page-shell-bg {
      background: linear-gradient(135deg, rgba(10, 14, 28, 0.92), rgba(6, 10, 20, 0.96));
    }
    table { border-collapse: collapse; }
    th { position: sticky; top: 0; z-index: 5; }
  </style>
  <script src="../constants.js"></script>
  <script src="../utils.js"></script>
  <script src="../payout-helpers.js"></script>
  <script src="../ui-enhancements.js"></script>
  <script src="../kintsugi-core.js"></script>
</head>
<body class="m-0 p-[18px] font-sans text-kintsugi-text-primary bg-black overflow-x-hidden leading-normal">
  <div class="max-w-[1600px] mx-auto">
    <!-- Top Navigation -->
    <header class="flex flex-col items-center justify-start gap-3 mb-5">
      <div>
        <div class="text-4xl font-bold tracking-wide text-center relative pb-1 brand-title-gradient brand-title-line">
          Kintsugi Motorworks
        </div>
        <div class="mt-1.5 text-md uppercase tracking-[0.22em] text-kintsugi-text-secondary text-center">
          Mechanic performance profiles
        </div>
      </div>

      <nav class="inline-flex p-1 rounded-full bg-gradient-to-br from-[rgba(10,16,32,0.98)] to-[rgba(15,23,42,0.95)] border border-[rgba(79,70,229,0.15)] gap-1 shadow-[0_8px_24px_rgba(0,0,0,0.7),0_0_1px_rgba(79,70,229,0.5)] backdrop-blur-sm" aria-label="Primary navigation">
        <a href="../index.html" class="px-[22px] py-2 rounded-full text-base text-kintsugi-text-secondary border border-transparent transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden hover:text-kintsugi-text-primary hover:bg-kintsugi-accent-hover hover:border-[rgba(79,70,229,0.35)] hover:-translate-y-px">Dashboard</a>
        <a href="../Payouts/payouts-index.html" class="px-[22px] py-2 rounded-full text-base text-kintsugi-text-secondary border border-transparent transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden hover:text-kintsugi-text-primary hover:bg-kintsugi-accent-hover hover:border-[rgba(79,70,229,0.35)] hover:-translate-y-px">Payouts</a>
        <a href="mechanics-index.html" class="px-[22px] py-2 rounded-full text-base text-white border border-[rgba(212,175,55,0.2)] transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden nav-pill-active">Mechanics</a>
        <a href="../Bank_Record/bank-index.html" class="px-[22px] py-2 rounded-full text-base text-kintsugi-text-secondary border border-transparent transition-all duration-[180ms] ease-[cubic-bezier(0.4,0,0.2,1)] cursor-pointer relative overflow-hidden hover:text-kintsugi-text-primary hover:bg-kintsugi-accent-hover hover:border-[rgba(79,70,229,0.35)] hover:-translate-y-px">Bank</a>
      </nav>
    </header>

    <main class="page-shell">
      <!-- Summary intro -->
      <section class="summary">
        <div class="summary-main">
          <div class="summary-title">Mechanic stats overview</div>
          <p class="summary-sub">
            Live totals and activity range pulled from jobs + payouts data.
          </p>
          <a
            class="link-soft"
            href="https://docs.google.com/spreadsheets/d/1EJxx9BAUyBgj9XImCXQ5_3nr_o5BXyLZ9SSkaww71Ks/edit"
            target="_blank"
            rel="noopener noreferrer"
          >
            Open source sheet
          </a>
        </div>
      </section>

      <!-- Global summary cards -->
      <section class="mechanics-summary-row" aria-label="Global mechanic summary">
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Total mechanics</div>
          <div id="sumTotalMechanics" class="mechanics-summary-value">–</div>
          <div id="sumTotalMechanicsSub" class="mechanics-summary-sub"></div>
        </div>
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Total repairs</div>
          <div id="sumTotalRepairs" class="mechanics-summary-value">–</div>
          <div id="sumTotalRepairsSub" class="mechanics-summary-sub"></div>
        </div>
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Lifetime mechanic payout</div>
          <div id="sumTotalPayout" class="mechanics-summary-value">–</div>
          <div id="sumTotalPayoutSub" class="mechanics-summary-sub"></div>
        </div>
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Activity range</div>
          <div id="sumActivityRange" class="mechanics-summary-value">–</div>
          <div id="sumActivityRangeSub" class="mechanics-summary-sub"></div>
        </div>
      </section>

      <!-- Controls -->
      <section class="controls" aria-label="Mechanic filters">
        <span class="label-soft">Mechanic:</span>
        <span class="select-wrap">
          <select id="mechanicFilter" class="select-pill">
            <option value="all">All mechanics</option>
          </select>
        </span>

        <span class="label-soft">Time:</span>
        <span class="select-wrap">
          <select id="timeFilter" class="select-pill">
            <option value="all">All time</option>
            <option value="last4w">Last 4 weeks</option>
            <option value="last3m">Last 3 months</option>
            <option value="last6m">Last 6 months</option>
            <option value="last12m">Last 12 months</option>
            <option value="thisMonth">This month</option>
          </select>
        </span>

        <span class="label-soft">Sort by:</span>
        <span class="select-wrap">
          <select id="sortBy" class="select-pill">
            <option value="totalRepairs">Total repairs</option>
            <option value="avgPerWeek">Average repairs / week</option>
            <option value="weeksWorked">Weeks worked</option>
            <option value="monthsActive">Months active</option>
            <option value="lifetimePayout">Lifetime payout</option>
            <option value="name">Mechanic name (A → Z)</option>
          </select>
        </span>

        <span class="label-soft">Search:</span>
        <span class="input-wrap">
          <input
            id="searchBox"
            class="search-input"
            type="search"
            placeholder="Search mechanic name..."
          />
        </span>
      </section>

      <!-- Mechanics table + details + weekly summary -->
      <section class="mechanics-layout">
        <!-- Left side: Mechanics table and lifetime details -->
        <div class="mechanics-panel">
          <div class="panel-header">
            <div class="panel-title">Mechanics</div>
            <div id="mechanicsTableSub" class="panel-subtitle">
              All mechanics. All time.
            </div>
          </div>

          <div class="table-wrap">
            <table class="table mechanics-table">
              <thead>
                <tr>
                  <th>Mechanic</th>
                  <th>Total repairs</th>
                  <th>Weeks worked</th>
                  <th>Months active</th>
                  <th>Avg / week</th>
                  <th>Lifetime payout</th>
                  <th>Last job</th>
                </tr>
              </thead>
              <tbody id="mechanicsBody"></tbody>
            </table>
          </div>

          <!-- Mechanic detail integrated under table -->
          <div class="mechanic-detail-shell">
            <div class="panel-header panel-header-detail">
              <div id="detailTitle" class="panel-title">Mechanic details</div>
              <div id="detailSubtitle" class="panel-subtitle">
                Select a mechanic from the table or dropdown.
              </div>
            </div>
            <div id="mechanicDetail" class="mechanic-detail">
              <div class="mechanic-detail-empty">
                No mechanic selected. Choose a mechanic to see breakdown for
                repairs, weeks worked and payout.
              </div>
            </div>
          </div>
        </div>

        <!-- Right side: Weekly payout summary -->
        <div class="weekly-summary-panel">
          <div class="panel-header">
            <div class="panel-title">Weekly Payout Summary</div>
            <div id="weeklySummarySubtitle" class="panel-subtitle">
              Select a mechanic to view weekly breakdown.
            </div>
          </div>
          
          <div id="weeklySummaryContent" class="weekly-summary-content">
            <div class="weekly-summary-empty">
              No mechanic selected. Choose a mechanic to see their weekly payout summary.
            </div>
          </div>
        </div>
      </section>

      <div id="status" class="status"></div>
    </main>
  </div>

  <script src="mechanics-script.js"></script>
</body>
</html>
