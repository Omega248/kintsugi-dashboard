<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kintsugi Motorworks · Mechanics</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="../shared-styles.css" />
  <link rel="stylesheet" href="mechanics-style.css" />
  <script src="../constants.js"></script>
  <script src="../utils.js"></script>
  <script src="../ui-enhancements.js"></script>
  <script src="../kintsugi-core.js"></script>
</head>
<body>
  <div class="app">
    <!-- Top Navigation -->
    <header class="top-bar">
      <div>
        <div class="brand-title">Kintsugi Motorworks</div>
        <div class="brand-sub">Mechanic performance profiles</div>
      </div>

      <nav class="nav-tabs" aria-label="Primary navigation">
        <a href="../index.html" class="nav-pill">Dashboard</a>
        <a href="../Payouts/payouts-index.html" class="nav-pill">Payouts</a>
        <a href="mechanics-index.html" class="nav-pill active">Mechanics</a>
        <a href="../Bank_Record/bank-index.html" class="nav-pill">Bank</a>
      </nav>
    </header>

    <main class="page-shell">
      <!-- Summary intro -->
      <section class="summary">
        <div class="summary-main">
          <div class="summary-title">Mechanic stats overview</div>
          <p class="summary-sub">
            Live totals and activity range pulled from jobs + payouts data.
          </p>
          <a
            class="link-soft"
            href="https://docs.google.com/spreadsheets/d/1EJxx9BAUyBgj9XImCXQ5_3nr_o5BXyLZ9SSkaww71Ks/edit"
            target="_blank"
            rel="noopener noreferrer"
          >
            Open source sheet
          </a>
        </div>
      </section>

      <!-- Global summary cards -->
      <section class="mechanics-summary-row" aria-label="Global mechanic summary">
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Total mechanics</div>
          <div id="sumTotalMechanics" class="mechanics-summary-value">–</div>
          <div id="sumTotalMechanicsSub" class="mechanics-summary-sub"></div>
        </div>
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Total repairs</div>
          <div id="sumTotalRepairs" class="mechanics-summary-value">–</div>
          <div id="sumTotalRepairsSub" class="mechanics-summary-sub"></div>
        </div>
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Lifetime mechanic payout</div>
          <div id="sumTotalPayout" class="mechanics-summary-value">–</div>
          <div id="sumTotalPayoutSub" class="mechanics-summary-sub"></div>
        </div>
        <div class="mechanics-summary-card">
          <div class="mechanics-summary-label">Activity range</div>
          <div id="sumActivityRange" class="mechanics-summary-value">–</div>
          <div id="sumActivityRangeSub" class="mechanics-summary-sub"></div>
        </div>
      </section>

      <!-- Controls -->
      <section class="controls" aria-label="Mechanic filters">
        <span class="label-soft">Mechanic:</span>
        <span class="select-wrap">
          <select id="mechanicFilter" class="select-pill">
            <option value="all">All mechanics</option>
          </select>
        </span>

        <span class="label-soft">Time:</span>
        <span class="select-wrap">
          <select id="timeFilter" class="select-pill">
            <option value="all">All time</option>
            <option value="last4w">Last 4 weeks</option>
            <option value="last3m">Last 3 months</option>
            <option value="last6m">Last 6 months</option>
            <option value="last12m">Last 12 months</option>
            <option value="thisMonth">This month</option>
          </select>
        </span>

        <span class="label-soft">Sort by:</span>
        <span class="select-wrap">
          <select id="sortBy" class="select-pill">
            <option value="totalRepairs">Total repairs</option>
            <option value="avgPerWeek">Average repairs / week</option>
            <option value="weeksWorked">Weeks worked</option>
            <option value="monthsActive">Months active</option>
            <option value="lifetimePayout">Lifetime payout</option>
            <option value="name">Mechanic name (A → Z)</option>
          </select>
        </span>

        <span class="label-soft">Search:</span>
        <span class="input-wrap">
          <input
            id="searchBox"
            class="search-input"
            type="search"
            placeholder="Search mechanic name..."
          />
        </span>
      </section>

      <!-- Mechanics table + details in a single panel -->
      <section class="mechanics-layout">
        <div class="mechanics-panel">
          <div class="panel-header">
            <div class="panel-title">Mechanics</div>
            <div id="mechanicsTableSub" class="panel-subtitle">
              All mechanics. All time.
            </div>
          </div>

          <div class="table-wrap">
            <table class="table mechanics-table">
              <thead>
                <tr>
                  <th>Mechanic</th>
                  <th>Total repairs</th>
                  <th>Weeks worked</th>
                  <th>Months active</th>
                  <th>Avg / week</th>
                  <th>Lifetime payout</th>
                  <th>Last job</th>
                </tr>
              </thead>
              <tbody id="mechanicsBody"></tbody>
            </table>
          </div>

          <!-- Mechanic detail integrated under table -->
          <div class="mechanic-detail-shell">
            <div class="panel-header panel-header-detail">
              <div id="detailTitle" class="panel-title">Mechanic details</div>
              <div id="detailSubtitle" class="panel-subtitle">
                Select a mechanic from the table or dropdown.
              </div>
            </div>
            <div id="mechanicDetail" class="mechanic-detail">
              <div class="mechanic-detail-empty">
                No mechanic selected. Choose a mechanic to see breakdown for
                repairs, weeks worked and payout.
              </div>
            </div>
          </div>
        </div>
      </section>

      <div id="status" class="status"></div>
    </main>
  </div>

  <script src="mechanics-script.js"></script>
</body>
</html>
